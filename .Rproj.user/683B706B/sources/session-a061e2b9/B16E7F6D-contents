---
title: "Определение температуры поверхности по космическим снимкам"
format: html
---

Подготовлено по материалам телеграм канала "[О картах"](https://t.me/mapnotes) - <https://gommersh.notion.site/361cd5e111174365afcb777143bcd078>

# Описание расчета

Определение температуры поверхности по космическим снимкам основано на анализе теплового излучения, зарегистрированного инфракрасными сенсорами на спутниках. Эти данные позволяют точно измерять температурные характеристики земной поверхности и водных объектов, что критично для исследований в области изменения климата, горожов, мониторинга лесных пожаров, оценки состояния сельскохозяйственных угодий и управления водными ресурсами.

На сайте геологической службы США можно скачать космоснимки, среди них есть отдельная группа снимков Ландсат, которые представляют собой информацию о температуре приземного слоя. Такие снимки помечены префиксом ST (“Surface temperature”).

![](images/image1.webp){fig-align="center"}

| ST_URAD  | восходящее тепловое излучение                                  |
|----------|----------------------------------------------------------------|
| ST_DRAD  | нисходящее тепловое излучение                                  |
| ST_ATRAN | атмосферная прозрачность (проницаемость атмосферы)             |
| ST_EMIS  | поверхностная излучательная способность                        |
| ST_EMSD  | стандартное отклонение поверхностной излучательной способности |
| ST_QA    | неопределенность полосы измерения, в кельвинах                 |
| ST_CDIST | расстояние в пикселях от ближайшего определенного облака       |
| ST_B10   | температура земной поверхности, измеряется в Кельвинах         |

Чтобы исследовать температуру земной поверхности нам нужен файл с **ST_B10**. Если посмотреть на реальные данные, то можно увидеть, что числа в пикселях в данном канале совсем не похожи на реальные показатели температуры. А значит, нужно как-то преобразовать существующие данные.

![](images/image%20(3).webp){fig-align="center"}

Подробное описание преобразования данных в температуру есть в [технической документации](https://d9-wret.s3.us-west-2.amazonaws.com/assets/palladium/production/s3fs-public/media/files/LSDS-1619_Landsat8-9-Collection2-Level2-Science-Product-Guide-v6.pdf).

![](images/image%20(4).webp){fig-align="center"}

Для значений этого канала есть некий multiplicative scale factor и additive offset:

-   Multiplicative scale factor (MSF) – чтобы получить температуру, на это число нужно умножать значение пикселя. Слово multiplicative указывает на то, что значение пикселя нужно умножать на это число.

-   Addtive Offset (AO) - специальное число, которое нужно добавить, чтобы получить температуру приземного слоя. Слово additive указывает на то, что к значению пикселя нужно прибавить это число.

Также заметьте, что значения в данном канале представлены в *кельвинах*. Поэтому от полученного значения нужно будет отнять 273,15 чтобы получить температуру не в кельвинах, а в градусах цельсия.

Учитываем все это, и у нас получается формула температуры приземного слоя для ландсат 8-9:

$$LST_{rescaled} = LST*MSF+ AO - 273,5$$

Значение пикселя в канале 10 умножаем на MSF, прибавляем АО и отнимаем 273,15. Теперь подставим числа и получим финальную формулу:

$$LST_{rescaled} = B\_10\_ST*0.00341802 + 149 - 273,5$$

Эту формулу мы будем использовать для того, чтобы из значения пикселя получить температуру поверхности земли в градусах цельсия.

# Расчет температуры

**Шаг 1. Скачиваем космоснимок**

Снимки можно скачать с сайта геологической службы США (процесс скачивания снимков описан в разделе [Открытые данные дистанционного зондирования](https://baltti.github.io/marchi-dpo/remote-sensing-data.html)).

::: callout-important
Здесь вам подойдут только снимки Landsat-8 или Landsat-9.

Причем вам достаточно скачать только 10 канал, прочие для расчета температуры не требуются.

![](images/image%20(5).webp){fig-align="center"}
:::

**Шаг 2. Считаем температуру**

Открываем QGIS и добавляем в пустой проект наш снимок.

![](images/image%20(6).webp){fig-align="center"}

Откроем калькулятор растра (*Растр* $\longrightarrow$ Калькулятор растра) и воспользуемся формулой:

$$LST_{rescaled} = LST*MSF+ AO - 273,5$$

Вместо B_10_ST поставим наше значение из рассматриваемого растра.

![](images/image%20(7).webp)

::: callout-caution
В калькуторе растров лучше сохранять результат не в виде временного растра, а сразу в файл, так как сохранение во временный растр может привести к ошибкам и некорректным расчетам.
:::

Далее при необходимости можно обрезать снимок и подобрать цветовой градиент для лучшей иллюстрации температурных аномалий.

![](images/image%20(8).webp)

Что можно с этим делать:

-   Наглядно показать, как нагревается асфальт в городе и насколько он влияет на общую температуру в районе;

-   Наглядно показать обратное - как хорошо влияет зелень на среднюю температуру;

-   Оценить городские острова тепла;

-   Оценить изменение температуры в динамике и отметить температурные тренды.

![](images/Макет_1.webp){fig-align="center"}

![](images/2024_08_15.webp)

![Источник: https://t.me/gisgoo/262](images/photo_2024-03-27_17-07-50.jpg){fig-align="center"}

![Источник: https://app.geohub.ru/maps/1685](images/photo_2025-03-05_15-32-46.jpg)

::: callout-note
Более подробно про расчет температуры поверхности можно почитать по [ссылке](https://wiki.gis-lab.info/w/%D0%9E%D1%86%D0%B5%D0%BD%D0%BA%D0%B0_%D1%82%D0%B5%D0%BC%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D1%83%D1%80%D1%8B_%D0%BF%D0%BE%D0%B2%D0%B5%D1%80%D1%85%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%B8%D0%B7_%D1%81%D0%BD%D0%B8%D0%BC%D0%BA%D0%B0_Landsat-8_%D0%BF%D1%80%D0%B8_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D0%B8_Land_Surface_Temperature_QGIS_Plugin).
:::
